<h2>
  <%= @conversation.name %> (with: 
  <% @conversation.users.each do |user| %>
    <%= "#{user.username} " unless user.id == current_user.id %>
  <% end %>)
  <span><%= link_to 'Edit', edit_conversation_path, class: 'btn btn-secondary' %></span>
</h2>
<div class="chat-box">
  <section class="chat-box__content">
    <% @conversation.messages.each do |message| %>
      <p>
        <% if message.removed? %>
          'This message was removed'
        <% else %>
          <%= message.content %>
          <span class=""><%= link_to 'Update', edit_conversation_message_path(@conversation, message),
            class: 'btn btn-primary btn-sm' %></span>
          <span class="">
            <%= link_to 'Delete', [@conversation, message], method: :delete, class: 'btn btn-danger btn-sm' %>
          </span>
        <% end %>
        <%= @user_names[message.user_id] %> <%= message.date %>
        <% if message.image.attached? %>
          <image src="<%=(url_for(message.image))%>">
        <% end %>
      </p>
    <% end %>
  </section>

  <section class="chat-box__input">
    <div class="mb-3">
      <%= form_with model: @message, url: conversation_messages_path(@conversation, @message) do |form| %>
        <div class="card">
          <div class="card-body">
            <div class="input-group mb-3">
              <%= form.text_field :content, class: 'form-control' %>
              <%= form.submit 'Send', class: 'btn btn-info' %>
            </div>
            <div class="row g-2">
              <div class="col-auto">
                <%= form.label :image, 'Add Image: ', class: 'form-label' %>
              </div>
              <div class="col-auto">
                <%= form.file_field :image, class: 'form-control form-control-sm' %>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </section>
</div>
</br>
<%= link_to 'Home page', root_path, class: 'btn btn-sm btn-outline-secondary' %>
